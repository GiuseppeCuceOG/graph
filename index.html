<html>
<head>
	<meta charset="utf-8">
	<title>Map of Italy</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="style.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
</head>
<body>
	<div id="title">
		Map of Italy - Population per city
	</div>
	<div>
		<script>

			var larghezza = 550;
			var lunghezza = 750;
			var lat = "latitude";
			var longi = "longitude";
			var pop = "population";
			var rMin = 1.2;
			var rMax = 80;

			var svg = d3.select("body").append("svg")
				.attr("width", larghezza)
				.attr("height", lunghezza);

			var xScale = d3.scale.linear().range([0 +30, larghezza -30]);
			var yScale = d3.scale.linear().range([lunghezza -30, 0 +30]);
			var pScale = d3.scale.linear().range([rMin, rMax]);

			function render (data) {
				xScale.domain(d3.extent(data, function (d) { return d[longi]; }));
				yScale.domain(d3.extent(data, function (d) { return d[lat]; }));
				pScale.domain(d3.extent(data, function (d) { return d[pop]; }));

				var circles = svg.selectAll("circle").data(data);

				circles.enter().append("circle");
				circles
					.attr("cx", function (d) { return xScale(d[longi]); })
					.attr("cy", function (d) { return yScale(d[lat]); })
					.attr("r", function (d) { return pScale(d[pop]); })

				circles.exit().remove();
			}

			function type(d) {
				d.latitude = +d.latitude;
				d.longitude = +d.longitude;
				d.population = +d.population;
				return d;
			}

			d3.csv("cities.csv", type, render);

		</script>
	</div>
</body>
</html>